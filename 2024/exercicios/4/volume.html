<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>CS50x em Portugu√™s</title>

    <!-- http://getbootstrap.com/docs/4.5/getting-started/introduction/ -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/popper.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>

    <!-- https://momentjs.com/, https://momentjs.com/timezone/ -->
    <script src="/static/js/moment.min.js"></script>
    <script src="/static/js/moment-timezone-with-data.min.js"></script>
    <script src="/static/js/luxon.min.js"></script>

    <!-- https://www.algolia.com/doc/guides/building-search-ui/installation/js/ -->
    <script src="/static/js/algoliasearchLite.min.js"></script>
    <script src="/static/js/instantsearch.production.min.js"></script>
    <script src="/static/js/jekyll-theme-cs50.js"></script>

    <script id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/static/highlight/highlight.min.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/static/highlight/styles/vs.min.css"/>
    <link rel="stylesheet" href="/static/css/page.css">

    <style>
      code {
        color: black;
        border: 1px solid #dee2e6;
      }

      pre > code {
        padding: 0 !important;
      }

      pre {
        border: 1px solid #dee2e6;
      }

      .mermaid {
        background-color: white !important;
        border: none !important;
      }
    </style>
  </head>

  <body>
    <!-- Markdown Flux Diagrams -->
    <script type="module">
      mermaid.initialize({startOnLoad: true});
    </script>
    <div class="container-fluid">
      <div class="row">
        <aside class="col-md" style="background-color: darkgreen">
  <header>
    <h1>
      <a href="">CS50x em Portugu√™s</a>
    </h1>

    <p>
      <a target="_blank" href=""></a>
      <br/>
      2024
    </p>
  </header>

  <button class="btn btn-sm collapsed d-md-none" aria-controls="nav" aria-expanded="false" data-target="aside &gt; nav" data-toggle="collapse">
    Menu
  </button>

  <nav class="collapse d-md-block" id="nav">
    <hr/>

    <ul>
      <li>
        <a href="/2024/semanas/0.html">Semana
          0</a>
        Scratch üò∫
      </li>
      <li>
        <a href="/2024/semanas/1.html">Semana
          1</a>
        C
      </li>
      <li>
        <a href="/2024/semanas/2.html">Semana
          2</a>
        Arrays
      </li>
      <li>
        <a href="/2024/semanas/3.html">Semana
          3</a>
        Algoritmos
      </li>
      <li>
        <a href="/2024/semanas/4.html">Semana
          4</a>
        Mem√≥ria
      </li>
      <li>
        <a href="/2024/semanas/5.html">Semana
          5</a>
        Estruturas de Dados
      </li>
      <li>
        <a href="/2024/semanas/6.html">Semana
          6</a>
        Python
      </li>
      <li>
        <a href="/2024/semanas/7.html">Semana
          7</a>
        SQL
      </li>
      <li>
        <a href="/2024/semanas/8.html">Semana
          8</a>
        HTML, CSS, JavaScript
      </li>
      <li>
        <a href="/2024/semanas/9.html">Semana
          9</a>
        Flask
      </li>
      <li>
        <a href="/2024/semanas/10.html">Semana
          10</a>
        Seguran√ßa Cibern√©tica
      </li>
    </ul>

    <hr/>

    <ul>
      <li>
        <a href="/2024/projeto.html">Projeto Final</a>
      </li>
    </ul>

    <hr/>

    <ul>
      <li>
        <a href="/2024/honestidade.html">Honestidade Acad√™mica</a>
      </li>
      <li>
        <a href="/2024/certificado.html">Certificado CS50</a>
      </li>
      <li>
        <a href="/2024/perguntas-frequentes.html">Perguntas Frequentes</a>
      </li>
      <li>
        <a href="https://cs50.me/cs50x">Livro de Notas</a>
      </li>
      <li>
        <a href="/2024/equipe.html">Equipe</a>
      </li>
      <li>
        <a href="/2024/plano-de-curso.html">Plano de Curso</a>
      </li>
    </ul>
    <hr/>

    <ul>
      <li>
        <a href="/manual/index.html">P√°ginas do Manual</a>
      </li>
      <li>
        <a href="/2024/estilo.html">Guia de Estilo</a>
      </li>
    </ul>
  </nav>
</aside>
        <main class="col-md markdown-body">
          

  <h2>Volume</h2>
<p><img alt="Forma de onda do arquivo WAV" src="https://cs50.harvard.edu/x/2024/psets/4/volume/wav_file.png" /></p>
<h2>Problema a resolver</h2>
<p><a href="https://docs.fileformat.com/audio/wav/">Arquivos WAV</a> s√£o um formato de arquivo comum para representar √°udio. Os arquivos WAV armazenam o √°udio como uma sequ√™ncia de "amostras": n√∫meros que representam o valor de algum sinal de √°udio em um ponto espec√≠fico no tempo. Os arquivos WAV come√ßam com um "cabe√ßalho" de 44 bytes que cont√©m informa√ß√µes sobre o arquivo em si, incluindo o tamanho do arquivo, o n√∫mero de amostras por segundo e o tamanho de cada amostra. Ap√≥s o cabe√ßalho, o arquivo WAV cont√©m uma sequ√™ncia de amostras, cada uma delas um √∫nico inteiro de 2 bytes (16 bits) representando o sinal de √°udio em um ponto espec√≠fico no tempo.</p>
<p>Escalar cada valor de amostra por um determinado fator tem o efeito de alterar o volume do √°udio. Multiplicar cada valor de amostra por 2.0, por exemplo, ter√° o efeito de dobrar o volume do √°udio de origem. Multiplicar cada amostra por 0,5, por sua vez, ter√° o efeito de reduzir o volume pela metade.</p>
<p>Em um arquivo chamado <code>volume.c</code> em uma pasta chamada <code>volume</code>, escreva um programa para modificar o volume de um arquivo de √°udio.</p>
<h2>Demonstra√ß√£o</h2>
<script async="" data-autoplay="1" data-cols="100" data-loop="1" data-rows="12" id="asciicast-mc2hPhYDt1spoMjlqNMuqC4Uc" src="https://asciinema.org/a/mc2hPhYDt1spoMjlqNMuqC4Uc.js"></script>

<h2>C√≥digo de distribui√ß√£o</h2>
<p>Para este problema, voc√™ estender√° a funcionalidade do c√≥digo fornecido a voc√™ pela equipe do CS50.</p>
<p>Fa√ßa login em <a href="https://cs50.dev/">cs50.dev</a>, clique na janela do seu terminal e execute <code>cd</code> sozinho. Voc√™ deve descobrir que o prompt da janela do seu terminal se parece com o abaixo:</p>
<pre><code>  $
</code></pre>
<p>Em seguida, execute</p>
<pre><code>  wget https://cdn.cs50.net/2023/fall/psets/4/volume.zip
</code></pre>
<p>para baixar um ZIP chamado <code>volume.zip</code> no seu codespace.</p>
<p>Em seguida, execute</p>
<pre><code>  unzip volume.zip
</code></pre>
<p>para criar uma pasta chamada <code>volume</code>. Voc√™ n√£o precisa mais do arquivo ZIP, ent√£o voc√™ pode executar</p>
<pre><code>  rm volume.zip
</code></pre>
<p>e responda com "y" seguido por Enter no prompt para remover o arquivo ZIP que voc√™ baixou.</p>
<p>Agora digite</p>
<pre><code>  cd volume
</code></pre>
<p>seguido por Enter para mover-se para (ou seja, abrir) esse diret√≥rio. Seu prompt agora deve se parecer com o abaixo.</p>
<pre><code>  volume/ $
</code></pre>
<p>Se tudo foi bem-sucedido, voc√™ deve executar</p>
<pre><code>  ls
</code></pre>
<p>e ver um arquivo chamado <code>volume.c</code>. Executar o <code>c√≥digo volume.c</code> deve abrir o arquivo onde voc√™ digitar√° seu c√≥digo para este conjunto de problemas. Se n√£o, refa√ßa seus passos e veja se consegue determinar onde voc√™ errou!</p>
<h2>Detalhes da implementa√ß√£o</h2>
<p>Conclua a implementa√ß√£o de <code>volume.c</code> para que ele altere o volume de um arquivo de som por um determinado fator.</p>
<ul>
<li>O programa deve aceitar tr√™s argumentos de linha de comando. O primeiro √© <code>input</code>, que representa o nome do arquivo de √°udio original. O segundo √© <code>output</code>, que representa o nome do novo arquivo de √°udio que deve ser gerado. O terceiro √© <code>factor</code>, que √© a quantidade pela qual o volume do arquivo de √°udio original deve ser escalado.<ul>
<li>Por exemplo, se <code>factor</code> for <code>2.0</code>, seu programa deve dobrar o volume do arquivo de √°udio em <code>input</code> e salvar o arquivo de √°udio rec√©m-gerado em <code>output</code>.</li>
</ul>
</li>
<li>Seu programa deve primeiro ler o cabe√ßalho do arquivo de entrada e gravar o cabe√ßalho no arquivo de sa√≠da.</li>
<li>Seu programa deve ent√£o ler o restante dos dados do arquivo WAV, uma amostra de 16 bits (2 bytes) por vez. Seu programa deve multiplicar cada amostra pelo <code>factor</code> e gravar a nova amostra no arquivo de sa√≠da.<ul>
<li>Voc√™ pode assumir que o arquivo WAV usar√° valores assinados de 16 bits como amostras. Na pr√°tica, os arquivos WAV podem ter v√°rios n√∫meros de bits por amostra, mas assumiremos amostras de 16 bits para este problema.</li>
</ul>
</li>
<li>Seu programa, se usar <code>malloc</code>, n√£o deve vazar nenhuma mem√≥ria.</li>
</ul>
<h2>Dicas</h2>
<h3>Entenda o c√≥digo em <code>volume.c</code></h3>
<p>Observe primeiro que <code>volume.c</code> j√° est√° configurado para receber tr√™s argumentos de linha de comando, <code>input</code>, <code>output</code> e <code>factor</code>.</p>
<ul>
<li><code>main</code> usa um <code>int</code>, <code>argc</code>, e uma matriz de <code>char *</code>s (strings!), <code>argv</code>.</li>
<li>Se <code>argc</code>, o n√∫mero de argumentos na linha de comando incluindo o pr√≥prio programa, n√£o for igual a 4, o programa imprimir√° seu uso adequado e sair√° com o c√≥digo de status 1.<pre><code>    int main(int argc, char \*argv[])
    {
        // Verifique os argumentos da linha de comando
        if (argc != 4)
        {
            printf("Uso: ./volume input.wav output.wav factor\n");
            return 1;
        }

        // ...
    }
</code></pre>
</li>
</ul>
<p>O <code>volume.c</code> seguinte usa o <a href="https://manual.cs50.io/3/fopen"><code>fopen</code></a> para abrir os dois arquivos fornecidos como argumentos de linha de comando.</p>
<ul>
<li>√â uma boa pr√°tica verificar se o resultado de chamar <code>fopen</code> √© <code>NULL</code>. Se for, o arquivo n√£o foi encontrado ou n√£o p√¥de ser aberto.<pre><code>    // Abra arquivos e determine o fator de escala
    FILE *input = fopen(argv[1], "r");
    if (input == NULL)
    {
        printf("N√£o foi poss√≠vel abrir o arquivo.\n");
        return 1;
    }

    FILE *output = fopen(argv[2], "w");
    if (output == NULL)
    {
        printf("N√£o foi poss√≠vel abrir o arquivo.\n");
        return 1;
    }
</code></pre>
</li>
</ul>
<p>Mais tarde, esses arquivos s√£o fechados com <code>fclose</code>. Sempre que voc√™ chamar <code>fopen</code>, chame <code>fclose</code> posteriormente!</p>
<pre><code>      // Feche os arquivos
      fclose(input);
      fclose(output);
</code></pre>
<p>Antes de fechar os arquivos, perceba que temos alguns TODOs.</p>
<pre><code>      // TODO: Copie o cabe√ßalho do arquivo de entrada para o arquivo de sa√≠da

      // TODO: Leia as amostras do arquivo de entrada e grave os dados atualizados no arquivo de sa√≠da
</code></pre>
<p>Provavelmente voc√™ precisar√° saber o fator pelo qual escalar o volume, por isso <code>volume.c</code> j√° converte o terceiro argumento da linha de comando em um <code>float</code> para voc√™!</p>
<pre><code>      float factor = atof(argv[3]);
</code></pre>
<h3>Copiar o cabe√ßalho WAV do arquivo de entrada para o arquivo de sa√≠da</h3>
<p>Sua primeira tarefa √© copiar o cabe√ßalho do arquivo WAV de <code>entrada</code> e grav√°-lo em <code>sa√≠da</code>. Antes disso, por√©m, voc√™ precisar√° aprender alguns tipos de dados especiais.</p>
<p>At√© agora, vimos v√°rios tipos diferentes em C, incluindo <code>int</code>, <code>bool</code>, <code>char</code>, <code>double</code>, <code>float</code> e <code>long</code>. No entanto, dentro de um cabe√ßalho chamado <code>stdint.h</code> h√° declara√ß√µes de v√°rios tipos <em>outros</em> que nos permitem definir com muita precis√£o o tamanho (em bits) e o sinal (com ou sem sinal) de um inteiro. Dois tipos em particular ser√£o √∫teis quando trabalharmos com arquivos WAV:</p>
<ul>
<li><code>uint8_t</code> √© um tipo que armazena um inteiro de 8 bits (portanto, <code>8</code>!) sem sinal (ou seja, n√£o negativo) (portanto <code>uint</code>!). Podemos tratar cada byte do cabe√ßalho de um arquivo WAV como um valor <code>uint8_t</code>.</li>
<li><code>int16_t</code> √© um tipo que armazena um inteiro de 16 bits com sinal (ou seja, positivo ou negativo). Podemos tratar cada amostra de √°udio em um arquivo WAV como um valor <code>int16_t</code>.</li>
</ul>
<p>Voc√™ provavelmente vai querer criar uma matriz de bytes para armazenar os dados do cabe√ßalho do arquivo WAV que voc√™ ler√° do arquivo de entrada. Usando o tipo <code>uint8_t</code> para representar um byte, voc√™ pode criar uma matriz de <code>n</code> bytes para seu cabe√ßalho com sintaxe como</p>
<pre><code>  uint8_t header[n];
</code></pre>
<p>substituindo <code>n</code> pelo n√∫mero de bytes. Voc√™ pode ent√£o usar <code>header</code> como um argumento para <a href="https://manual.cs50.io/3/fread"><code>fread</code></a> ou <a href="https://manual.cs50.io/3/fwrite"><code>fwrite</code></a> para ler ou gravar no cabe√ßalho.</p>
<p>Lembre-se de que o cabe√ßalho de um arquivo WAV sempre tem exatamente 44 bytes de comprimento. Observe que <code>volume.c</code> j√° define uma vari√°vel para voc√™ chamada <code>HEADER_SIZE</code>, igual ao n√∫mero de bytes no cabe√ßalho.</p>
<p>O que est√° abaixo √© uma dica e tanto, mas aqui est√° como voc√™ pode realizar essa tarefa!</p>
<pre><code>  // Copiar cabe√ßalho do arquivo de entrada para o arquivo de sa√≠da
  uint8_t header[HEADER_SIZE];
  fread(header, HEADER_SIZE, 1, input);
  fwrite(header, HEADER_SIZE, 1, output);
</code></pre>
<h3>Gravar dados atualizados no arquivo de sa√≠da</h3>
<p>Sua pr√≥xima tarefa √© ler amostras de <code>entrada</code>, atualizar essas amostras e gravar as amostras atualizadas em <code>sa√≠da</code>. Ao ler arquivos, √© comum criar um "buffer" no qual os dados s√£o temporariamente armazenados. L√°, voc√™ pode modificar os dados e, quando estiverem prontos, gravar os dados do buffer em um novo arquivo.</p>
<p>Lembre-se de que podemos usar o tipo <code>int16_t</code> para representar uma amostra de um arquivo WAV. Para armazenar uma amostra de √°udio, ent√£o, voc√™ pode criar uma vari√°vel de buffer com sintaxe como:</p>
<pre><code>  // Criar um buffer para uma √∫nica amostra
  int16_t buffer;
</code></pre>
<p>Com um buffer para amostras no lugar, agora voc√™ pode ler dados nele, uma amostra por vez. Tente usar <code>fread</code> para esta tarefa! Voc√™ pode usar <code>&amp;buffer</code>, o endere√ßo de <code>buffer</code>, como um argumento para <code>fread</code> ou <code>fwrite</code> para ler ou gravar no buffer. (Lembre-se que o operador <code>&amp;</code> √© usado para obter o endere√ßo da vari√°vel.)</p>
<pre><code>  // Criar um buffer para uma √∫nica amostra
  int16_t buffer;

  // Ler amostra √∫nica no buffer
  fread(&amp;buffer, sizeof(int16_t), 1, input)
</code></pre>
<p>Agora, para aumentar (ou diminuir) o volume de uma amostra, voc√™ s√≥ precisa multiplic√°-la por algum fator.</p>
<pre><code>  // Criar um buffer para uma √∫nica amostra
  int16_t buffer;

  // Ler amostra √∫nica no buffer
  fread(&amp;buffer, sizeof(int16_t), 1, input)

  // Atualizar volume da amostra
  buffer *= factor;
</code></pre>
<p>E, finalmente, voc√™ pode gravar essa amostra atualizada em <code>sa√≠da</code>:</p>
<pre><code>  // Criar um buffer para uma √∫nica amostra
  int16_t buffer;

  // Ler amostra √∫nica da entrada para o buffer
  fread(&amp;buffer, sizeof(int16_t), 1, input)

  // Atualizar volume da amostra
  buffer *= factor;

  // Gravar amostra atualizada no novo arquivo
  fwrite(&amp;buffer, sizeof(int16_t), 1, output);
</code></pre>
<p>H√° apenas um problema: voc√™ precisar√° <em>continuar</em> lendo uma amostra em seu buffer, atualizando seu volume e gravando a amostra atualizada no arquivo de sa√≠da enquanto ainda houver amostras para ler.</p>
<ul>
<li>Felizmente, de acordo com sua documenta√ß√£o, <code>fread</code> retornar√° o n√∫mero de itens de dados lidos com sucesso. Voc√™ pode achar √∫til verificar quando voc√™ chegou ao final do arquivo!</li>
<li>Tenha em mente que n√£o h√° raz√£o para que voc√™ n√£o possa chamar <code>fread</code> dentro da condicional de um loop <code>while</code>. Voc√™ poderia, por exemplo, fazer uma chamada para <code>fread</code> como a seguinte:<pre><code>    while (fread(...))
    {

    }
</code></pre>
</li>
</ul>
<p>√â uma grande dica, mas veja abaixo uma maneira eficiente de resolver esse problema:</p>
<pre><code>  // Criar um buffer para uma √∫nica amostra
  int16_t buffer;

  // Ler amostra √∫nica da entrada para o buffer enquanto houver amostras para ler
  while (fread(&amp;buffer, sizeof(int16_t), 1, input) != 0)
  {
      // Atualizar volume da amostra
      buffer *= factor;

      // Gravar amostra atualizada no novo arquivo
      fwrite(&amp;buffer, sizeof(int16_t), 1, output);
  }
</code></pre>
<p>Como a vers√£o de C que voc√™ est√° usando trata valores diferentes de zero como <code>true</code> e valores zero como <code>false</code>, voc√™ pode simplificar a sintaxe acima para o seguinte:</p>
<pre><code>  // Criar um buffer para uma √∫nica amostra
  int16_t buffer;

  // Ler amostra √∫nica da entrada para o buffer enquanto houver amostras para ler
  while (fread(&amp;buffer, sizeof(int16_t), 1, input))
  {
      // Atualizar volume da amostra
      buffer *= factor;

      // Gravar amostra atualizada no novo arquivo
      fwrite(&amp;buffer, sizeof(int16_t), 1, output);
  }
</code></pre>
<h2>Passo a passo</h2>
<div class="ratio ratio-16x9" data-video=""><iframe allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" class="border" data-video="" src="https://www.youtube.com/embed/LiGhjz9ColQ?modestbranding=0&amp;rel=0&amp;showinfo=0"></iframe></div>

<details><summary>N√£o tem certeza como resolver?</summary><div class="ratio ratio-16x9" data-video=""><iframe allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" class="border" data-video="" src="https://www.youtube.com/embed/-rtZkTAK2gg?modestbranding=0&amp;rel=0&amp;showinfo=0"></iframe></div></details>

<h2>Como testar</h2>
<p>O seu programa deve comportar-se de acordo com os exemplos abaixo.</p>
<pre><code>  $ ./volume input.wav output.wav 2.0
</code></pre>
<p>Quando ouvir <code>output.wav</code> (por exemplo, clicando com controle em <code>output.wav</code> no navegador de arquivos, escolhendo <strong>Baixar</strong>, e depois abrindo o arquivo em um player de √°udio em seu computador), ele deve estar duas vezes mais alto que <code>input.wav</code>!</p>
<pre><code>  $ ./volume input.wav output.wav 0.5
</code></pre>
<p>Quando ouvir <code>output.wav</code>, ele deve estar na metade da altura de <code>input.wav</code>!</p>
<h3>Precis√£o</h3>
<pre><code>  check50 cs50/problems/2024/x/volume
</code></pre>
<h3>Estilo</h3>
<pre><code>  style50 volume.c
</code></pre>
<h2>Como enviar</h2>
<pre><code>  submit50 cs50/problems/2024/x/volume
</code></pre>


        </main>
      </div>
    </div>
  </body>

</html>