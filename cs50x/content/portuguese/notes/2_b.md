Depuração
---------

*   Bugs são erros em programas que não pretendíamos cometer. E a depuração é o processo de encontrar e corrigir bugs.

help50 e printf
-----------------

*   Digamos que escrevemos este programa, `buggy0.c`:
    
        int main(void)
        {
            printf("hello, world\n");
        }
        

    *   Vemos um erro (em vermelho), quando tentamos `make` neste programa, que estamos `declarando implicitamente a função da biblioteca 'printf'`. Não entendemos muito bem isso, então podemos executar `help50 make buggy0`, que nos dirá, no final, que talvez tenhamos esquecido de escrever `#include <stdio.h>`, que contém `printf`.
*   Podemos tentar novamente com `buggy1.c`:
    
        #include <stdio.h>
        
        int main(void)
        {
            string name = get_string("Qual é o seu nome?\n");
            printf("hello, %s\n", name);
        }
        

    *   Vemos muitos erros e até mesmo o primeiro não parece fazer muito sentido. Então podemos executar novamente `help50 make buggy1`, que nos dará a dica de que precisamos de `cs50.h` já que `string` não está definida.
*   Para limpar a janela do terminal (para que possamos ver apenas a saída do que queremos executar em seguida), podemos pressionar `control + L` ou digitar `clear` como um comando na janela do terminal.
*   Vamos dar uma olhada em `buggy2.c`:
    
        #include <stdio.h>
        
        int main(void)
        {
            for (int i = 0; i <= 10; i++)
            {
                printf("#\n");
            }
        }
        

    *   Hmm, pretendíamos ver apenas 10 `#`s, mas há 11. Se não soubéssemos qual é o problema (já que nosso programa está compilando sem erros e agora temos um erro lógico), poderíamos adicionar outra linha de impressão para nos ajudar:
    
            #include <stdio.h>
            
            int main(void)
            {
                for (int i = 0; i <= 10; i++)
                {
                    printf("i agora é %i: ", i);
                    printf("#\n");
                }
            }
            
        
    *   Agora, vemos que `i` começou em 0 e continuou até chegar a 10, mas deveríamos pará-lo quando estiver em 10, com `i < 10` em vez de `i <= 10`.

debug50
-------

*   Hoje também daremos uma olhada no CS50 IDE, que é como o CS50 Sandbox, mas com mais recursos. É um ambiente de desenvolvimento online, com um editor de código e uma janela do terminal, mas também ferramentas para depurar e colaborar:
    ![janela do navegador com CS50 IDE, editor de código na parte superior com buggy2.c, janela do terminal na parte inferior](https://cs50.harvard.edu/x/2020/notes/2/cs50_ide.png)
*   No CS50 IDE, teremos outra ferramenta, `debug50`, para nos ajudar a depurar programas.
*   Vamos abrir `buggy2.c` e tentar `make buggy2`. Mas salvamos `buggy2.c` em uma pasta chamada `src2`, então precisamos executar `cd src2` para mudar nosso diretório para o correto. E o terminal do CS50 IDE nos lembrará em qual diretório estamos, com um prompt como `~/src/ $`. (O `~` indica o diretório padrão, ou diretório pessoal).
*   Em vez de usar `printf`, também podemos depurar nosso programa de forma interativa. Podemos adicionar um _ponto de interrupção_, ou um indicador para uma linha de código onde o depurador deve pausar nosso programa. Por exemplo, podemos clicar à esquerda da linha 5 de nosso código, e um círculo vermelho aparecerá:
    ![editor de código com ícone vermelho ao lado da linha 5 do código](https://cs50.harvard.edu/x/2020/notes/2/breakpoint.png)
*   Agora, se executarmos `debug50 ./buggy2`, veremos o painel do depurador abrir à direita:
    ![painel do depurador com controles e variáveis](https://cs50.harvard.edu/x/2020/notes/2/debugger_panel.png)
*   Vemos que a variável que criamos, `i`, está na seção `Variáveis locais` e vemos que tem um valor de `0`.
*   Nosso ponto de interrupção pausou nosso programa após a linha 5, logo antes da linha 7, já que é a primeira linha de código que pode ser executada. Para continuar, temos alguns controles no painel do depurador. O triângulo azul continuará nosso programa até chegarmos a outro ponto de interrupção ou ao final do programa. A seta curva à direita dele irá "pular" a linha, executando-a e pausando nosso programa novamente imediatamente depois.
*   Então, usaremos a seta curva para executar a próxima linha e ver o que muda. Estamos na linha `printf` e, pressionando a seta curva novamente, vemos um único `#` impresso em nossa janela do terminal. Com mais um clique na seta, vemos o valor de `i` à direita mudar para `1`. E podemos continuar clicando na seta para acompanhar a execução do nosso programa, uma linha de cada vez.
*   Para sair do depurador, podemos pressionar `control + C` para parar o programa.
*   Podemos economizar muito tempo no futuro investindo um pouco agora para aprender como usar o `debug50`!