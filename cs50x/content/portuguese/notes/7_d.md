Várias tabelas
--------------

*   Mas cada uma das linhas terá apenas uma coluna para gêneros, e os valores serão múltiplos gêneros juntos. Portanto, podemos voltar para nosso programa de importação e adicionar outra tabela:
    
        import cs50
        import csv
        
        # Criar o banco de dados
        open(f"shows4.db", "w").close()
        db = cs50.SQL("sqlite:///shows4.db")
        
        # Criar as tabelas
        db.execute("CREATE TABLE shows (id INT, title TEXT, year NUMERIC, PRIMARY KEY(id))")
        
        # A tabela `genres` terá uma coluna chamada `show_id` que faz referência
        # à tabela `shows` acima
        db.execute("CREATE TABLE genres (show_id INT, genre TEXT, FOREIGN KEY(show_id) REFERENCES shows(id))")
        
        # Abrir o arquivo TSV
        # https://datasets.imdbws.com/title.basics.tsv.gz
        with open("title.basics.tsv", "r") as titles:
        
            # Criar o DictReader
            reader = csv.DictReader(titles, delimiter="\t")
        
            # Percorrer o arquivo TSV
            for row in reader:
        
                # Se for uma série de TV não para adultos
                if row["titleType"] == "tvSeries" and row["isAdult"] == "0":
        
                    # Se tiver um ano definido
                    if row["startYear"] != "\\N":
        
                        # Se for a partir de 1970
                        startYear = int(row["startYear"])
                        if startYear >= 1970:
        
                            # Remover o prefixo de tconst
                            id = int(row["tconst"][2:])
        
                            # Inserir o show
                            db.execute("INSERT INTO shows (id, title, year) VALUES(?, ?, ?)", id, row["primaryTitle"], startYear)
        
                            # Inserir os gêneros
                            if row["genres"] != "\\N":
                                for genre in row["genres"].split(","):
                                    db.execute("INSERT INTO genres (show_id, genre) VALUES(?, ?)", id, genre)
        
    
    *   Agora, nossa tabela `shows` não possui mais uma coluna `genres`, mas em vez disso, temos uma tabela `genres` em que cada linha representa um show e um gênero associado. Agora, um show específico pode ter vários gêneros que podemos pesquisar, e podemos obter outros dados sobre o show na tabela `shows` usando seu ID.'