Arquivos
-----

*   Com a capacidade de usar ponteiros, também podemos abrir arquivos:
    
        #include <cs50.h>
        #include <stdio.h>
        #include <string.h>
        
        int main(void)
        {
            // Abre o arquivo
            FILE *file = fopen("agenda.csv", "a");
        
            // Obtém strings do usuário
            char *nome = get_string("Nome: ");
            char *numero = get_string("Número: ");
        
            // Escreve as strings no arquivo
            fprintf(file, "%s,%s\n", nome, numero);
        
            // Fecha o arquivo
            fclose(file);
        }
        
    
    *   `fopen` é uma nova função que podemos usar para abrir um arquivo. Ela retornará um ponteiro para um novo tipo, `FILE`, que podemos ler e escrever. O primeiro argumento é o nome do arquivo e o segundo argumento é o modo que queremos abrir o arquivo (`r` para ler, `w` para escrever e `a` para acrescentar, ou adicionar).
    *   Depois de obtermos algumas strings, podemos usar `fprintf` para escrever no arquivo.
    *   Por fim, fechamos o arquivo com `fclose`.
*   Agora podemos criar nossos próprios arquivos CSV, arquivos de valores separados por vírgula (como uma mini-planilha), de forma programática.

JPEG
====

*   Também podemos criar um programa que abre um arquivo e nos informa se é um arquivo JPEG (imagem):
    
        #include <stdio.h>
        
        int main(int argc, char *argv[])
        {
            // Verifica o uso
            if (argc != 2)
            {
                return 1;
            }
        
            // Abre o arquivo
            FILE *file = fopen(argv[1], "r");
            if (!file)
            {
                return 1;
            }
        
            // Lê os primeiros três bytes
            unsigned char bytes[3];
            fread(bytes, 3, 1, file);
        
            // Verifica os primeiros três bytes
            if (bytes[0] == 0xff && bytes[1] == 0xd8 && bytes[2] == 0xff)
            {
                printf("Talvez\n");
            }
            else
            {
                printf("Não\n");
            }
        
            // Fecha o arquivo
            fclose(file);
        }
        
    
    *   Agora, se executarmos esse programa com `./jpeg brian.jpg`, nosso programa tentará abrir o arquivo especificado (verificando se realmente obtivemos um arquivo não nulo) e ler os primeiros três bytes do arquivo com `fread`.
    *   Podemos comparar os primeiros três bytes (em hexadecimal) com os três bytes necessários para iniciar um arquivo JPEG. Se forem iguais, então nosso arquivo provavelmente é um arquivo JPEG (embora outros tipos de arquivos ainda possam começar com esses bytes). Mas, se eles não forem iguais, sabemos que definitivamente não é um arquivo JPEG.
*   Podemos usar essas habilidades para ler e escrever arquivos, em particular imagens, e modificá-los alterando os bytes neles, no conjunto de problemas desta semana!